workflows:
  hello-world:
    environment:
      flutter: stable

    triggering:
     events:
       - "push"
     branch_patterns:
       - pattern: 'main'
       - include: true
         source: true

    name: Hello world

    scripts:
      - name: Hello world
        script: echo 'change message'

      - name: CREATE ENV
        script: mkdir env

      - name: CREATE PROD.JSON
        script: echo '{"name":"Hello world"}' > env/prod.json

      - name: FLUTTER TESTS
        script: flutter test

      - name: FLUTTER ANALYZE
        script: flutter analyze

      - name: FLUTTER CREATE APK
        script: flutter build apk --release --dart-define-from-file=env/prod.json

      - name: FLUTTER CREATE IPA
        script: flutter build ipa --release --dart-define-from-file=env/prod.json

    artifacts:
      - build/app/outputs/flutter-apk/app-release.apk

    publishing:
      email:
        recipients:
          - estev97@gmail.com
          - meedu.app@gmail.com
